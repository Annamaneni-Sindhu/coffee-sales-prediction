# -*- coding: utf-8 -*-
"""Heart Failure Survival Prediction

Automatically generated by Colab.

Original file is located at
    https://colab.research.google.com/drive/1dlh7dUDr9B9CCyduheTxIiMxfePWwGbj
"""

import pandas as pd
import numpy as np
import matplotlib.pyplot as plt
import seaborn as sns
from sklearn.model_selection import train_test_split
from sklearn.linear_model import LogisticRegression
from sklearn.metrics import accuracy_score,confusion_matrix,classification_report

df=pd.read_csv("heart_failure_clinical_records_dataset.csv")
print("First 5 rows in dataset")
print(df.head())
print("\n Dataset Info:")
print(df.info())

print("\n Missing Values:")
print(df.isnull().sum())

sns.countplot(x="DEATH_EVENT",data=df)
plt.title("Death Event Distribution")
plt.xlabel("Death Event(0=Alive,1=Dead)")
plt.ylabel("Count")
plt.show()
sns.boxplot(x="DEATH_EVENT",y="age",data=df)
plt.title("Age vs Death Event")
plt.show()
sns.boxplot(x="DEATH_EVENT",y="ejection_fraction",data=df)
plt.title("Ejection Fraction vs Death Event")
plt.show()

x=df.drop("DEATH_EVENT",axis=1)
y=df["DEATH_EVENT"]

x_train,x_test,y_train,y_test=train_test_split(x,y,test_size=0.2,random_state=42)

model=LogisticRegression(max_iter=1000)
model.fit(x,y)

new_patient=[[78,1,600,1,18,1,21000,3.5,120,1,1,25]]
prediction=model.predict(new_patient)
if prediction[0]==1:
  print("High Risk-Patient may not survive")
else:
  print("Low Risk-Patient may survive")

y_pred=model.predict(x_test)

accuracy=accuracy_score(y_test,y_pred)
print("\n Model accuracy:",round(accuracy*100,2),"%")
print("\n Confusion Matrix:")
print("Confusion_matrix(y_test,y_pred)")
print("\n Classification Report:")
print(classification_report(y_test,y_pred))

feature_importance=pd.DataFrame({"Feature":x.columns,
                                 "Coefficient":model.coef_[0]}).sort_values(by="Coefficient",ascending=False)
print("\n Feature Importance:")
print(feature_importance)
plt.figure(figsize=(8,5))
sns.barplot(x="Coefficient",y="Feature",data=feature_importance)
plt.title("Feature Importance(Logistic Regression)")
plt.show()

